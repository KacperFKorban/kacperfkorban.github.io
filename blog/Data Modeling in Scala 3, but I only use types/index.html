<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="korban.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="korban.dev Atom Feed"><title data-react-helmet="true">Data Modeling in Scala 3, but I only use types | korban.dev</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://kacperfkorban.github.io/blog/Data Modeling in Scala 3, but I only use types"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Data Modeling in Scala 3, but I only use types | korban.dev"><meta data-react-helmet="true" name="description" content="That’s the whole idea."><meta data-react-helmet="true" property="og:description" content="That’s the whole idea."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-06-06T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/KacperFKorban"><meta data-react-helmet="true" property="article:tag" content="scala,scala 3"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kacperfkorban.github.io/blog/Data Modeling in Scala 3, but I only use types"><link data-react-helmet="true" rel="alternate" href="https://kacperfkorban.github.io/blog/Data Modeling in Scala 3, but I only use types" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kacperfkorban.github.io/blog/Data Modeling in Scala 3, but I only use types" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d05c7c29.css">
<link rel="preload" href="/assets/js/runtime~main.0de25d61.js" as="script">
<link rel="preload" href="/assets/js/main.bb8a9f9b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">korban.dev</b></a><a class="navbar__item navbar__link" href="/aboutme">About Me</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/KacperFKorban" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/blog/Data Modeling in Scala 3, but I only use types">Data Modeling in Scala 3, but I only use types</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/Achieving-Indisputable-Job-Security-Using-Novel-Scala-3-Features-A-Case-Study">Achieving Indisputable Job Security Using Novel Scala 3 Features: A Case Study</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/TASTY-way-of-rewriting-macros-in-Scala-3">TASTY way of (re)writing macros in Scala 3</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/How-to-write-Hoogle-for-Kotlin-in-Scala-and-Scala-js">How to write Hoogle for Kotlin in Scala (and Scala.js)</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Data Modeling in Scala 3, but I only use types</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-06-06T00:00:00.000Z" itemprop="datePublished">June 6, 2022</time> · <!-- -->8 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/KacperFKorban" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/39772805?v=4" alt="Kacper Korban"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/KacperFKorban" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Kacper Korban</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>That’s the whole idea.</p><p>We want to model data in Scala, but instead of using instances of classes at the term level, we want to use their type-constructors at the type level.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="recruitment-system">Recruitment system<a class="hash-link" href="#recruitment-system" title="Direct link to heading">​</a></h2><p>Let’s pick an example to help us visualize the whole process better, because just like a wise person once said “A picture is worth a thousand words”.</p><p>We will represent candidate profiles in a recruitment process for software engineering companies. Let’s start with the term model code and I’ll walk you through it.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">case class Candidate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  experience: List[Experience],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  otherQualities: List[String]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">case class Experience(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  duration: Int,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expLevel: ExpLevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  company: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  technologies: List[String]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum ExpLevel:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Junior</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Regular</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Senior</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case CEO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ExpLevel.*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We can represent candidates by providing their:</p><ul><li>name – just a String</li><li>experience history – list of Experience entries</li><li>other qualities – list of string</li></ul><p>And experience entry is represented by:</p><ul><li>duration – number of months at the job</li><li>experience level – enum value representing experience levels in IT</li><li>company name – a String</li><li>technologies – list of technologies used</li></ul><p>So if we were to create a very simplified profile using our model, it will look like this.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val candidate = Candidate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;John Paul&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Experience(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    29,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Junior,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;VirtusLab&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;Scala&quot; :: Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) :: Nil,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Motivated&quot; :: Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Cool, nothing new so far.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="making-it-spicier">Making it spicier<a class="hash-link" href="#making-it-spicier" title="Direct link to heading">​</a></h2><p>That was some basic Scala. Now what we want to do: is to be able to have all this information on the type level.</p><p>You might be asking: We already declared a model in the previous section. Can’t we just use that one?
As expected, the answer is: No. That’s because Scala distinguishes terms from types. The previous model worked on the term level, and we want to do it on the type level. So, we will have to tweak it a bit.</p><p>To make our intentions 100% clear, we want to be able to declare a type like the following (or at least similar).</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">type candidate = Candidate[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;John Paul&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Experience[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    29,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Junior,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;VirtusLab&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Scala&quot; :: Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ] :: Nil,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Motivated&quot; :: Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Let’s start our work with the most basic class and work our way up the dependency graph.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="experience-level">Experience level<a class="hash-link" href="#experience-level" title="Direct link to heading">​</a></h3><p>First, let’s look at <strong>ExpLevel</strong>. We declared it before as</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">enum ExpLevel:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Junior</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Regular</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Senior</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case CEO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ExpLevel.*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When we think about it, its type constructors carry the same amount of information as its data constructors, so we could leave it as it is.
There is a small problem with the current declaration though. When we want to access the type of <code>Junior</code> and use it as e.g. a type parameter for <code>List</code>, we cannot just say <code>List[Junior]</code>. That’s because there is no such type constructor as <code>Junior</code>. Instead, we will have to type <code>List[Junior.type]</code>. This can be quite annoying, specifically when it’s a part of the interface exposed to the user.
Is there a way to fix it then? Yes, and it’s actually quite simple. Just like by writing in Python I can force myself into a crippling depression, you can force Scala to generate classes for all our cases by just adding parentheses after the constructors. Then, those won’t just be values, but classes with empty constructors.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">enum ExpLevel:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Junior()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Regular()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case Senior()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case CEO()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ExpLevel.*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Nice, on to the next one.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="experience">Experience<a class="hash-link" href="#experience" title="Direct link to heading">​</a></h3><p>Now that we fixed the <code>ExpLevel</code> data type, let’s move on to Experience. In the term model, it looked like this</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">case class Experience(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  duration: Int,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expLevel: ExpLevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  company: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  technologies: List[String]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We want all of those term parameters to become type parameters, so let’s try just adding them.
The strategy will be, for every term parameter we will:</p><ol><li>create a type parameter with the same name</li><li>add a type constraint for it using &lt;: operator</li></ol><p>It is important that we use &lt;: here and not :. That is because, when used on types, the first one is semantically equivalent to “is subtype of” and the latter means “has implicit instance of”.
Let’s take a look at the result of our transformation then.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">case class Experience[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  duration &lt;: Int,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expLevel &lt;: ExpLevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  company &lt;: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  technologies &lt;: List[String]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>At first glance, it looks ok and it looks very similar to the term model. We have an entry for every parameter and the constraints are the same as before. But does it work? Well, no. If I were to play the role of a build tool, I would say that we have one warning and one error.</p><p>Let’s start with the warning. Take a look at this class and think, what does the <code>case</code> keyword give us here. Well, it gives us the <code>apply</code> function to our empty constructor, <code>getters</code> to our non-existent fields, the <code>unapply</code> function for a class we will never construct, and some other extremely useful methods.
Do you get the point? The <code>case</code> keyword here is just as useful as a cats-effect expert at Ziverge.</p><p>Cool. On to the error now. This one might not be as easy to spot. To make it easier, let’s look at how List is implemented. Skipping a lot of details, we have:</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed abstract class List[+A]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final case class :: [+A](head: A, next: List[A]) extends List[A]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">case object Nil extends List[Nothing]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We have a supertype <code>List</code> and two type constructors <code>::</code> (cons) and <code>Nil</code>.
<code>Nil</code>, carries no information since it just symbolizes an empty list. No problem here.
But, when we take a look at <code>::</code>, it only has one type parameter. This would mean that it will only be able to carry the definition of one <code>String</code>.</p><p>Let’s create our own data structure then. To make it easier, it should only contain <code>String</code>s.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed trait StrList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Nl extends StrList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class :|:[head &lt;: String, tail &lt;: StrList] extends StrList</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Voila. We just take a look at the definition of List and move every term parameter to type-level, like before.</p><p>If we put all the parts together, we get.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">class Experience[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  duration &lt;: Int,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expLevel &lt;: ExpLevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  company &lt;: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  technologies &lt;: StrList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="candidate">Candidate<a class="hash-link" href="#candidate" title="Direct link to heading">​</a></h3><p>Let’s take a look at our last class – <code>Candidate</code>.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">case class Candidate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  experience: List[Experience],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  otherQualities: List[String]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Right off the bat, we can spot similar problems as with <code>Experience</code> – Lists. Fortunately, we already have a structure for type-level lists of Strings from before. This means that we just need lists of <code>Experience</code>s. We can declare it in a similar way as with lists of strings, right? Let’s try.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed trait Experiences</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Empty extends Experiences</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class :+:[head &lt;: ???, tail &lt;: Experiences] extends Experiences</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Ok. This looks exactly like the <code>StrList</code> with some minor name changes. Why is there a question mark instead of the constraint of head? That’s because we cannot use <code>Experience</code> there. <code>Experience</code> is a type constructor that takes a non-empty parameter list. We would have to specify it on the spot.</p><p>Is there some trick we can use here? Or is Scala’s type system not expressive enough?
Of course, there is a workaround. It is also quite a common pattern. It’s every functional programmer’s biggest nightmare and every object-oriented programmer’s wet dream: <code>Inheritance</code>.</p><p>If we add a supertype to our <code>Experience</code> class, we can use it in every place where we would usually use a type and treat <code>Experience</code> as the implementation.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed trait Exp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Experience[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">] extends Exp</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Is this solution pretty? No.
But as the tapeworm said: There was no other way.</p><p>Now that we have fixed this issue, there is nothing interesting anymore with transforming the <code>Candidate</code> class.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">class Candidate[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name &lt;: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  experience &lt;: Experiences,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  otherQualities &lt;: StrList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="final-form">Final form<a class="hash-link" href="#final-form" title="Direct link to heading">​</a></h2><p>After all that work we can finally write our correct example instance.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">type mystery = Candidate[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;John Paul&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Experience[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    29,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Junior,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;VirtusLab&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Scala&quot; :|: Nl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ] :+: Empty,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Motivated&quot; :|: Nl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>And it compiles, which means that it works!</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="cmon-do-something">C&#x27;mon, Do Something<a class="hash-link" href="#cmon-do-something" title="Direct link to heading">​</a></h2><p>Now, you’re probably thinking: “Cool, we can model data now but there is more to computer systems than just data.” There is always some domain logic that needs to be implemented. In our case, we should definitely add some sanity checks. Like removing any experience in Rust and adding a “Good sense of humor” quality instead.</p><p>Can we do that? Yes, but since this blog post is already longer than the documentation for <code>http4s</code> I will have to end it here and if this blog post gets enough views, I will write a part II.</p><p>I hope the content was at least mildly interesting and that you didn’t take anything I wrote seriously. Especially type-level programming.</p><p>Medium link: <a href="https://medium.com/virtuslab/data-modeling-in-scala-3-but-i-only-use-types-b6f11ead4c28" target="_blank" rel="noopener noreferrer">https://medium.com/virtuslab/data-modeling-in-scala-3-but-i-only-use-types-b6f11ead4c28</a></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/scala">scala</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/scala-3">scala 3</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/KacperFKorban/kacperfkorban.github.io/blog/2022-06-06-Data-Modeling-in-Scala-3-but-I-only-use-types.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/Achieving-Indisputable-Job-Security-Using-Novel-Scala-3-Features-A-Case-Study"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Achieving Indisputable Job Security Using Novel Scala 3 Features: A Case Study<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#recruitment-system" class="table-of-contents__link toc-highlight">Recruitment system</a></li><li><a href="#making-it-spicier" class="table-of-contents__link toc-highlight">Making it spicier</a><ul><li><a href="#experience-level" class="table-of-contents__link toc-highlight">Experience level</a></li><li><a href="#experience" class="table-of-contents__link toc-highlight">Experience</a></li><li><a href="#candidate" class="table-of-contents__link toc-highlight">Candidate</a></li></ul></li><li><a href="#final-form" class="table-of-contents__link toc-highlight">Final form</a></li><li><a href="#cmon-do-something" class="table-of-contents__link toc-highlight">C&#39;mon, Do Something</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Content</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social media</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/KacperKorban" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/KacperFKorban" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 korban.dev, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0de25d61.js"></script>
<script src="/assets/js/main.bb8a9f9b.js"></script>
</body>
</html>